<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>STAC — Network Module (Prototype)</title>

  <!-- styles -->
  <link rel="stylesheet" href="style/main.css" />

  <!-- D3 -->
  <script src="https://d3js.org/d3.v7.min.js"></script>

  <style>
    /* ========== Node Detail Overlay ========== */
    .node-page {
      position: fixed;
      inset: 0;
      background: #fff;
      z-index: 1200;
      display: none;
      flex-direction: column;
      overflow: auto;
      -webkit-overflow-scrolling: touch;
    }
    .node-page-header {
      padding: 20px;
      border-bottom: 1px solid #eef2f6;
      display: flex;
      align-items: center;
      justify-content: space-between;
      background: #f9fafb;
    }
    .node-page .content {
      padding: 20px;
      max-width: 920px;
      margin: 0 auto;
      width: 100%;
    }
    .node-page h2 {
      margin: 0 0 8px 0;
      font-size: 20px;
    }
    .node-page .meta {
      color: #6b7280;
      margin-bottom: 18px;
    }
    .node-field {
      margin-bottom: 12px;
    }
    .node-field label {
      display: block;
      font-size: 13px;
      color: #6b7280;
      margin-bottom: 6px;
    }
    .node-field input, .node-field textarea {
      width: 100%;
      padding: 10px;
      border: 1px solid #e6eef6;
      border-radius: 8px;
      font-size: 14px;
      background: #fff;
      box-sizing: border-box;
    }
    .node-actions {
      display: flex;
      gap: 10px;
      margin-top: 12px;
    }
    .btn {
      padding: 10px 14px;
      border-radius: 8px;
      border: 0;
      cursor: pointer;
      font-weight: 600;
    }
    .btn.primary {
      background: #3a86ff;
      color: #fff;
    }
    .btn.ghost {
      background: transparent;
      color: #374151;
      border: 1px solid #e6eef6;
    }
  </style>
</head>

<body>
  <div class="app">
    <aside class="sidebar" id="sidebar">
      <div class="brand">
        <h1>STAC · Network</h1>
        <p class="muted">Prototype module</p>
      </div>

      <section class="controls">
        <h3>Quick Add</h3>
        <label>Node label</label>
        <input id="nodeLabel" placeholder="e.g. France" />
        <label>Group</label>
        <select id="nodeGroup">
          <option value="NATO">NATO</option>
          <option value="CSTO">CSTO</option>
        </select>
        <button id="addNodeBtn" class="primary">Add node</button>

        <hr/>

        <h3>Add link</h3>
        <label>Source (label)</label>
        <input id="linkSource" placeholder="Source label" />
        <label>Target (label)</label>
        <input id="linkTarget" placeholder="Target label" />
        <label>Relationship</label>
        <input id="linkType" placeholder="e.g. Alliance" />
        <button id="addLinkBtn" class="primary">Add link</button>

        <hr/>

        <h3>Filters & tools</h3>
        <div class="filters">
          <button class="filter" data-filter="all">All</button>
          <button class="filter" data-filter="NATO">NATO</button>
          <button class="filter" data-filter="CSTO">CSTO</button>
        </div>

        <div class="tools">
          <button id="exportJson">Export JSON</button>
          <button id="downloadPNG">Export PNG</button>
          <button id="saveLocal">Save (local)</button>
          <button id="loadLocal">Load (local)</button>
          <label class="file-label">Import JSON <input id="importJson" type="file" accept=".json" /></label>
          <button id="resetNetwork" class="danger">Reset</button>
        </div>

        <div class="meta muted">
          <p>Tip: click a node to view details or edit its data. Hover a node for info. Use mousewheel to zoom.</p>
        </div>
      </section>
    </aside>

    <main class="main">
      <div id="canvasWrap">
        <svg id="networkSvg" preserveAspectRatio="xMidYMid meet"></svg>
        <div id="tooltip" class="tooltip" style="display:none;"></div>
      </div>
    </main>
  </div>

  <!-- Full-page Node Editor -->
  <div id="nodePage" class="node-page" aria-hidden="true">
    <div class="node-page-header">
      <div>
        <strong id="nodePageTitle">Node</strong>
        <div id="nodePageSubtitle" class="meta"></div>
      </div>
      <div style="display:flex;gap:8px;align-items:center">
        <button id="closeNodePage" class="btn ghost">Close</button>
        <button id="saveNodePage" class="btn primary">Save</button>
      </div>
    </div>

    <div class="content" id="nodePageContent">
      <div class="node-field">
        <label>Label</label>
        <input id="nodeEditLabel" />
      </div>
      <div class="node-field">
        <label>Group</label>
        <input id="nodeEditGroup" />
      </div>
      <div class="node-field">
        <label>Description</label>
        <textarea id="nodeEditDesc" rows="5"></textarea>
      </div>
    </div>
  </div>

  <!-- app script -->
  <script type="module" src="src/script.js"></script>
</body>
</html>
